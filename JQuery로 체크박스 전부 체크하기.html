<!--  체크박스  전체 체크할 때, 혹은 메일함에 모든 메일 체크하기처럼 전체 체크하는 문제-->

<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Document</title>


<script src="../../../IT_Lesson/수업예제/JQuery/jquery-1.11.0.min.js"></script>
<script>
		//---------------------------------------------------------------------
		// body 태그 안의 요소들을 읽어들인 이후 익명함수 내부의 자스코딩을 실행.
		//---------------------------------------------------------------------
		$(function(){
            //--------------------------------------
			// obj1 변수 선언하고 name='todoList_all' 을 가진 태그를 관리하는 JQuery 객체 생성해서 
			// 객체의 메모리 위치 주소 값을 obj1 에 저장하기
			//--------------------------------------

            var obj1 = $("[name='todoList_all']");
            //--------------------------------------
			// obj2 변수 선언하고 name='todoList' 을 가진 태그를 관리하는 JQuery 객체 생성해서 
			// 객체의 메모리 위치 주소 값을 obj2 에 저장하기
			//--------------------------------------

            var obj2 = $("[name='todoList']");
            
            //--------------------------------------
            // obj1 에 저장된 JQuery 객체가 관리하는 태그에 change 이벤트를 발생하면 실행할 구문 결정하기
            //--------------------------------------

			obj1.change(  function(){

                //--------------------------------------
                // 변수 isChecked 선언하고 change 이벤트가 발생한 태그의 체크여부 저장하기
                //<주의> 현재 this 는 change 이벤트가 발생한 태그를 지칭하는 선택자다.
                //--------------------------------------
                var thisObj = $(this);              ///this = change 이벤트가 발생한 변수 todoList_all의 메모리 위치 주소 값을 지칭하는 변수
                
                //--------------------------------------
                // 변수 isChecked에 true가 저장되어 있으면
                // 즉 change 이벤트가 발생한 태그의 체크가 되어있으면
                // (= 전체가 체크되어 있으면)
                //--------------------------------------
                var isChecked =  thisObj.prop("checked");           /// <참고> isChecked에는 체크 유무가 들어가있기 때문에 아래 구문이 아닌 obj2.prop("checked",isChecked)로 변수를 사용해도 괜찮다
                if(isChecked==true){
                   
                    //--------------------------------------
                    // 변수 obj2에 저장된 JQuery 객체가 관리하는 태그에 체크 넣기
                    // (= 오늘 할 일 4개 전부 체크 완료 되어있을 때)
                    //--------------------------------------
                    obj2.prop("checked",true);                ///obj2.siblings().prop("checked",true); 
                }
                //--------------------------------------
                // 변수 isChecked에 false 저장되어 있으면
                // 즉 change 이벤트가 발생한 태그의 체크가 안 되어 있으면
                // (= 전체 체크가 안 되어 있으면)
                //--------------------------------------                
                else{
                    //--------------------------------------   
                    // 변수 obj2에 저장된 JQuery 객체가 관리하는 태그에 체크 빼기
                    // (= 오늘 할 일 4개 전부 체크 완료가 아닐 때)
                    //--------------------------------------   
                    obj2.prop("checked",false);          ///obj2.siblings().prop("checked",false); 
                }
                        //--------------------------------------------------
						// <참고>위의 모든 코딩은 아래 코드로 대체 가능하다.
						//--------------------------------------------------
						// obj2.prop(  "checked", $(this).prop("checked")  );

            });

            //--------------------------------------
            // obj2 에 저장된 JQuery 객체가 관리하는 태그에 change 이벤트를 발생하면 실행할 구문 결정하기
            // 즉 독서, 운동, 설거지, 낮잠으로 체크박스에 체크가 들어가거나 체크가 빠지면 실행할 구문 설정하기
            //--------------------------------------        /// 4개의 체크 완 → obj1도 체크, 4개 체크 빠짐 → obj 체크 빠짐
            obj2.change(  function(){                       /// 4개의 체크박스를 관리하는 객체의 메위주

            //--------------------------------------
            // 독서, 운동, 설거지, 낮잠 이 체크되어 있는 개수를 얻어 변수에 저장하기
            //--------------------------------------


            /*  // 굉장히 비효율적이고 안좋은 답1 >> 이렇게 하면 추가된 체크박스를 포함할 수 없음.
                var checkedCnt=0;              
                if( obj2.eq(0).prop("checked") )  { checkedCnt++; }          // 첫번째 인덱스 번호를 가진 태그에 체크가 되어있으면 cnt++이 됨.
                if( obj2.eq(1).prop("checked") )  { checkedCnt++; }          // 2번째 인덱스 번호를 가진 태그에 체크가 되어있으면 cnt++이 됨.
                if( obj2.eq(2).prop("checked") )  { checkedCnt++; }          // 3번째 인덱스 번호를 가진 태그에 체크가 되어있으면 cnt++이 됨.
                if( obj2.eq(3).prop("checked") )  { checkedCnt++; }          // 4번째 인덱스 번호를 가진 태그에 체크가 되어있으면 cnt++이 됨.
                

                //--------------------------------------
                // 독서, 운동, 설거지, 낮잠 이 모두 체크가 되어 있으면
                //--------------------------------------    
                if( checkedCnt==4 ) {
                    obj1.prop("checked",true)
                }
                //--------------------------------------
                // 독서, 운동, 설거지, 낮잠이 모두 체크가 안 되어 있으면
                //--------------------------------------                
                else {
                    obj1.prop("checked",false)
                }
                
            //*************************************
            // 효율적인 답
            //*************************************
            //--------------------------------------    
            // 취미 관련 체크박스의 총 개수 얻기
            //--------------------------------------    
                var todoListCnt = obj2.length;  /// length: JQuery 객체가 가진 __ 를 리턴.
                //--------------------------------------    
                // 취미 관련 체크박스의 체크 개수 저장할 변수 checkedCnt 선언하고 0 저장하기
                //--------------------------------------    
                var checkedCnt=0;
                //--------------------------------------    
                // 반복문을 사용하여 취미 관련 체크박스에 차례대로 접근하여 체크가 되어 있으면
                // checkedCnt 변수 안에 1 업데이트하기    
                //--------------------------------------    
                for(var i=0; i<todoListCnt ; i++ ) {
                    if( obj2.eq(i).prop("checked") )  { checkedCnt++; }         ///JQuery 의 선택자로 사용했던 것들이 JQuery의 메소드와 겹치는 경우도 많음
                }
                //--------------------------------------
                // 독서, 운동, 설거지, 낮잠 이 모두 체크가 되어 있으면
                //--------------------------------------   
                    if( checkedCnt== todoListCnt ) {
                    obj1.prop("checked",true)
                    }

                //--------------------------------------
                // 독서, 운동, 설거지, 낮잠이 모두 체크가 안 되어 있으면
                //--------------------------------------   
                    else {
                        obj1.prop("checked",false)
                    }                
                */
                

            //*************************************
            // 굉장히 효율적인 답
            //*************************************
            //--------------------------------------    
            // 취미 관련 체크박스의 총 개수 얻기
            //--------------------------------------    
            var todoListCnt = obj2.length; 
            
            //--------------------------------------    
            // 취미 관련 체크박스의 체크 개수 저장할 변수 checkedCnt 선언하고 0 저장하기
            //--------------------------------------    
            var checkedCnt=obj.filter(":checked").length;      /// 체크가 된 태그를 모두 관리하는 JQuery 객체의 메위주 리턴하는 선택자 → .length가 붙어서 개수를 리턴하게 됨

            //--------------------------------------    
            // 전체 관련 체크박스에 체크를 넣기 또는 빼기
            // 단 조건은 취미 관련 체크박스가 모두 체크되어 이쓰면 전체 체크
            // 모두 체크되어 있지 않다면 전체 체크 안 하기.
            //--------------------------------------              
            obj1.prop("checked", todoListCnt==checkedCnt)         /// 총 개수와 체크된 개수가 같을 때 true


            //*************************************
            // 가장 정말 효율적인 답
            //*************************************

            obj1.prop(
                    "checked"
                    ,obj2.filter(":checked").length==obj2.length
            )


            
                 /*   내가 적은 오답(시행착오들)
                var thisObj2 = $(this); 
                var isChecked2 =  thisObj2.siblings().prop("checked");
                
                // var thisObj2 = $(this); 
                // var isChecked2 = $(this).siblings().prop("checked");

                 if(isChecked2){
                      obj1.prop("checked",true); 
                   
                  }
                  else{
                     obj1.prop("checked",false); 
                 }
                 */
            });
		})
</script>


</head>
<body>
	<center>
	<hr>
       

       <!-- change 이벤트를 todoList_all과 todoList 총 2개에 달아줘야함-->
	<input type="checkbox" name="todoList_all" >전체 완료                 
	<hr>
	<input type="checkbox" name="todoList" value="독서">독서<br>
	<input type="checkbox" name="todoList" value="운동">운동<br>
	<input type="checkbox" name="todoList" value="설거지">설거지<br>
	<input type="checkbox" name="todoList" value="낮잠">낮잠<br>
    <input type="checkbox" name="todoList" value="공연관람">공연관람
	</center>
</body>
</html>
